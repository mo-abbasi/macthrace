<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Match Race Results</title>
    <link rel="icon" type="image/png" href="icon.png">
    <link rel="stylesheet" href="styles.css">
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
            border: 1px solid #ddd;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;
        }

        th {
            background-color: #e0f7fa;
        }

        td {
            background-color: #ffffff;
        }

        td.diagonal {
            background-color: #007f5f;
            color: #ffffff;
        }
    </style>
</head>
<body>
    <h1>Live Match Race Results</h1>

    <!-- Table for displaying results -->
    <table>
        <thead>
            <tr id="header-row">
                <!-- Header cells will be populated here -->
            </tr>
        </thead>
        <tbody id="results-body">
            <!-- Result rows will be populated here -->
        </tbody>
    </table>

    <!-- Include the data.js file -->
    <script src="data.js"></script>
    
    <script>
        // Process and display the data after the data.js file is loaded
        document.addEventListener('DOMContentLoaded', () => {
            displayResults(eventData); // eventData is from data.js
        });

        function displayResults(data) {
            const teams = data.teams;
            const results = calculateResults(teams, data.completedRaces);
            const headerRow = document.getElementById('header-row');
            const resultsBody = document.getElementById('results-body');

            // Create header row
            let headerHTML = '<th>Teams</th>';
            teams.forEach(team => {
                headerHTML += `<th>${team}</th>`;
            });
            headerRow.innerHTML = headerHTML;

            // Create results rows
            teams.forEach(team => {
                let rowHTML = `<tr><td>${team}</td>`;
                teams.forEach(opponent => {
                    if (team === opponent) {
                        rowHTML += `<td class="diagonal">X</td>`; // Diagonal cells (team vs. itself)
                    } else {
                        const result = results[team][opponent];
                        rowHTML += `<td>${result !== undefined ? result : ''}</td>`;
                    }
                });
                rowHTML += '</tr>';
                resultsBody.innerHTML += rowHTML;
            });
        }

        function calculateResults(teams, completedRaces) {
            // Initialize the results matrix
            const results = {};
            teams.forEach(team => {
                results[team] = {};
                teams.forEach(opponent => {
                    if (team !== opponent) {
                        results[team][opponent] = ''; // Default value
                    }
                });
            });

            // Populate the results matrix based on completed races
            completedRaces.forEach(race => {
                const { winner, loser } = race;
                results[winner][loser] = 'Win';
                results[loser][winner] = 'Lose';
            });

            return results;
        }
    </script>
</body>
</html>
